<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Video Grid Persist</title>
<style>
/* CSS tetap sama seperti sebelumnya */
body{margin:0;font-family:sans-serif;background:#111;color:#fff;}
header{background:#222;padding:10px;display:flex;justify-content:flex-end;}
header button{padding:8px 12px;background:#0f0;color:#000;border:none;cursor:pointer;}
#videosGrid{display:grid;grid-template-columns:repeat(2,1fr);gap:15px;padding:15px;}
.video-container{position:relative;border:1px solid #444;height:180px;display:flex;justify-content:center;align-items:center;background:#000;cursor:pointer;overflow:hidden;}
.video-container button.delete-btn{position:absolute;top:5px;right:5px;padding:2px 5px;background:red;color:#fff;border:none;z-index:10;font-size:12px;cursor:pointer;}
#sidebar{position:fixed;top:0;right:-320px;width:300px;height:100%;background:#222;padding:15px;box-sizing:border-box;transition:0.3s;display:flex;flex-direction:column;z-index:20;}
#sidebar textarea{width:100%;height:80px;margin-bottom:10px;padding:5px;}
#sidebar button{padding:8px;background:#0f0;color:#000;border:none;cursor:pointer;}
#overlayVideo{display:none;position:fixed;top:0;left:0;right:0;bottom:0;background:#000;justify-content:center;align-items:center;z-index:50;}
#overlayVideo video,#overlayVideo iframe{width:90%;height:80%;}
#overlayVideo button{position:absolute;top:10px;right:10px;background:#0f0;color:#000;border:none;padding:5px 10px;cursor:pointer;font-size:16px;z-index:60;}
</style>
</head>
<body>
<header>
  <button id="toggleSidebar">Tambah Video</button>
</header>

<div id="videosGrid"></div>

<div id="sidebar">
  <textarea id="videoLinks" placeholder="Masukkan link video/embed, tiap baris 1 link"></textarea>
  <div style="display:flex; gap:5px; margin-bottom:5px;">
    <button id="addVideos" style="flex:1;">OK</button>
    <button id="closeSidebar" style="flex:1;">Tutup</button>
  </div>
</div>

<div id="overlayVideo">
  <button id="closeOverlay">X</button>
</div>
<script>
  const grid = document.getElementById("videosGrid");
const sidebar = document.getElementById("sidebar");
const toggleSidebarBtn = document.getElementById("toggleSidebar");
const closeSidebarBtn = document.getElementById("closeSidebar");
const addBtn = document.getElementById("addVideos");
const textarea = document.getElementById("videoLinks");
const overlay = document.getElementById("overlayVideo");

let videoURLs = JSON.parse(localStorage.getItem("videoURLs") || "[]");

// Sidebar toggle
toggleSidebarBtn.onclick = ()=> sidebar.style.right="0";
closeSidebarBtn.onclick = ()=> sidebar.style.right="-320px";

// Overlay close
document.getElementById("closeOverlay").onclick = ()=>{
  overlay.style.display="none";
  overlay.innerHTML='<button id="closeOverlay">X</button>';
};

// Generate embed
function generateEmbed(url){
  let embed;
  if(url.includes("drive.google.com")){
    let fileId = url.match(/\/d\/(.*?)\//)?.[1] || url.match(/id=(.*)/)?.[1];
    embed = document.createElement("iframe");
    embed.src = `https://drive.google.com/file/d/${fileId}/preview`;
    embed.allowFullscreen=true;
  } else if(url.match(/\.(mp4|webm|ogg)$/i)){
    embed=document.createElement("video");
    embed.src=url; embed.controls=true;
  } else {
    embed=document.createElement("iframe");
    embed.src=url;
  }
  embed.style.width="100%";
  embed.style.height="100%";
  return embed;
}

// Add video ke grid
function addVideoToGrid(url){
  if(videoURLs.includes(url)) return;
  const container=document.createElement("div");
  container.className="video-container";

  const delBtn=document.createElement("button");
  delBtn.textContent="X";
  delBtn.className="delete-btn";
  delBtn.onclick=(e)=>{
    e.stopPropagation();
    grid.removeChild(container);
    videoURLs = videoURLs.filter(u=>u!==url);
    localStorage.setItem("videoURLs",JSON.stringify(videoURLs));
  };
  container.appendChild(delBtn);

  container.appendChild(generateEmbed(url));

  container.onclick=()=>{
    overlay.style.display="flex";
    overlay.innerHTML='<button id="closeOverlay">X</button>';
    overlay.appendChild(generateEmbed(url));
    document.getElementById("closeOverlay").onclick = ()=>{
      overlay.style.display="none";
      overlay.innerHTML='<button id="closeOverlay">X</button>';
    };
  };

  grid.appendChild(container);
  videoURLs.push(url);
  localStorage.setItem("videoURLs",JSON.stringify(videoURLs));
}

// Load dari localStorage
videoURLs.forEach(url=>addVideoToGrid(url));

// Tombol tambah video
addBtn.onclick=()=>{
  const links = textarea.value.split("\n").map(l=>l.trim()).filter(l=>l);
  links.forEach(url=>addVideoToGrid(url));
  textarea.value="";
  sidebar.style.right="-320px";
};
  </script>
<script src="videos.js"></script>
  <script src="script.js"></script>
</body>
</html>
